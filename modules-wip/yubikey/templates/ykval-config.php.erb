<?php                                                             # -*- php -*-

# For the validation interface.
$baseParams = array ();
$baseParams['__YKVAL_DB_DSN__'] = "<%= db_dsn %>";
$baseParams['__YKVAL_DB_USER__'] = '<%= db_username %>';
$baseParams['__YKVAL_DB_PW__'] = '<%= db_password %>';
$baseParams['__YKVAL_DB_OPTIONS__'] = array();

# For the validation server sync
$baseParams['__YKVAL_SYNC_POOL__'] = <%= sync_pool %>;
# An array of IP addresses allowed to issue sync requests
# NOTE: You must use IP addresses here.
$baseParams['__YKVAL_ALLOWED_SYNC_POOL__'] = <%= allowed_sync_pool %>;

# Specify how often the sync daemon awakens
$baseParams['__YKVAL_SYNC_INTERVAL__'] = 10;
# Specify how long the sync daemon will wait for response
$baseParams['__YKVAL_SYNC_RESYNC_TIMEOUT__'] = 30;
# Specify how old entries in the database should be considered aborted attempts
$baseParams['__YKVAL_SYNC_OLD_LIMIT__'] = 10;

# These are settings for the validation server.
$baseParams['__YKVAL_SYNC_FAST_LEVEL__'] = 1;
$baseParams['__YKVAL_SYNC_SECURE_LEVEL__'] = 40;
$baseParams['__YKVAL_SYNC_DEFAULT_LEVEL__'] = 60;
$baseParams['__YKVAL_SYNC_DEFAULT_TIMEOUT__'] = 1;

// otp2ksmurls: Return array of YK-KSM URLs for decrypting OTP for
// CLIENT.  The URLs must be fully qualified, i.e., contain the OTP
// itself.
function otp2ksmurls ($otp, $client) {
<%= otp_to_ksmurls %>;
}

?>
